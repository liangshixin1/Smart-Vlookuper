Smart VLookUper 智能数据映射工具
一个基于PyQt6开发的智能Excel数据匹配和映射工具，支持一对一、一对多、多对一等多种匹配模式，具备AI助手功能和模糊匹配算法。
主要特性
核心功能

智能字段匹配: 使用模糊匹配算法和同义词词典，自动识别和匹配相似字段
多种匹配模式: 支持一对一、一对多、多对一数据匹配
批量数据处理: 优化的COM批量写入，大幅提升Excel处理性能
格式保护: 保持原有Excel格式和样式不变
安全写入: 防止文件损坏的安全写入机制

高级功能

AI数据助手: 集成DeepSeek AI，支持自然语言描述数据处理需求
配置管理: 支持保存和加载匹配方案，提高工作效率
自动检测: 智能识别表头行和数据起始列
实时预览: 数据字段实时预览，所见即所得

兼容性

双引擎支持: Excel COM (Windows) + openpyxl (跨平台)
格式兼容: 支持 .xlsx、.xlsm、.xls 等多种Excel格式
数据类型保护: 使用 dtype=str 确保手机号、工号等不被错误转换

安装依赖
bashpip install pyqt6 pandas openpyxl pywin32 thefuzz
AI功能（可选）
bashpip install openai

使用场景
典型应用

HR数据管理: 员工信息匹配和更新
客户资料整合: 多源客户数据合并
财务数据核对: 账单与记录的自动匹配
学生成绩录入: 成绩单与学生信息匹配
库存数据同步: 多系统间库存信息同步

支持的匹配类型

精确匹配: 完全相同的字段名
标准化匹配: 去除空格后的匹配
同义词匹配: 内置同义词词典（如"手机号码"↔"联系电话"）
模糊匹配: 基于相似度算法的智能匹配

🔧 使用方法
基础操作流程

选择匹配模式

一对一：单个信息源匹配单个目标表
一对多：单个信息源匹配多个目标表
多对一：多个信息源合并后匹配单个目标表


配置数据源

浏览选择Excel文件
选择工作表
设置表头行和数据起始列（支持自动检测）
提取字段并预览数据


设置匹配规则

选择索引字段（用于关联数据的关键字段）
使用"自动预填"进行智能字段匹配
手动调整匹配关系
选择写入模式（仅填充空值 / 覆盖所有值）


执行匹配

点击"执行匹配并导出"
系统自动生成结果文件
查看匹配统计信息



高级功能
AI助手使用

点击右下角橙色"AI"按钮
输入DeepSeek API Key
添加需要处理的表格文件
用自然语言描述处理需求
AI自动生成并执行处理代码

配置方案管理

保存方案: 将当前匹配配置保存为JSON文件
加载方案: 快速恢复之前保存的配置
适用于重复性数据处理任务

🛠️ 技术架构
核心组件

UI层: PyQt6现代化界面设计
数据处理: Pandas + openpyxl
匹配算法: thefuzz模糊匹配库
Excel操作: win32com.client (Windows) / openpyxl (跨平台)
AI集成: OpenAI API兼容接口

性能优化

批量写入: 按列批量操作而非逐格写入
内存管理: 及时释放资源，支持大文件处理
双写入引擎: COM引擎性能优先，openpyxl兼容性备选
数据去重: 智能处理重复索引记录

安全机制

格式保护: 完整保留Excel单元格格式
备份机制: 生成新文件而非覆盖原文件
异常处理: 完善的错误处理和资源释放
数据验证: 防止数据类型意外转换

📋 系统要求
最低配置

操作系统: Windows 7+ / macOS 10.12+ / Linux
Python版本: Python 3.7+
内存: 4GB RAM（推荐8GB+用于大文件处理）
磁盘空间: 100MB

推荐配置

操作系统: Windows 10/11（最佳COM支持）
办公软件: Microsoft Office 2016+（COM引擎优化）
内存: 8GB+ RAM
处理器: 四核心处理器

